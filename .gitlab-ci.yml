stages:
  - test

variables:
  PYTHONPATH: "$CI_PROJECT_DIR/src:$CI_PROJECT_DIR/test"

test:
  stage: test
  image: python:3.10  # Use a Python Docker image
  before_script:
    - pip install -r requirements.txt  # Install dependencies from requirements.txt
  script:
    - cd src  # Change to the `src` directory
    - coverage run --omit="test/*" -m unittest test.create_user_test
    - coverage run --append --omit="test/*" -m unittest test.filter_test
    - coverage run --append --omit="test/*" -m unittest test.location_test
    - coverage run --append --omit="test/*" -m unittest test.login_test
    - coverage run --append --omit="test/*" -m unittest test.user_test
    - coverage report  # Generate a coverage report

only:
  - branches  # Run on every commit to any branch
